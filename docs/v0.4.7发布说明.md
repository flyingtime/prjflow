# v0.4.7 发布说明

**发布日期**: 2025年12月01日

## 版本概述

v0.4.7 版本主要优化了用户界面交互体验，为所有管理页面添加了搜索栏折叠功能，优化了Bug列表界面显示，并新增了用户管理中的修改密码功能，提升了系统的易用性和管理效率。

## 主要更新

### 1. 项目选择下拉框输入过滤功能 🔍

#### 功能描述
为所有管理页面中的"选择项目"下拉框添加了输入过滤功能，用户可以通过输入关键词快速筛选和查找项目，提升选择效率。

#### 功能特点
- **实时过滤**：输入关键词时实时过滤项目列表
- **多字段匹配**：支持按项目名称和项目编码进行过滤
- **不区分大小写**：过滤时自动忽略大小写，提升易用性
- **统一体验**：所有页面的项目选择都支持过滤功能

#### 涉及的页面
- ✅ 项目管理 (`Project.vue`) - 搜索表单
- ✅ Bug管理 (`Bug.vue`) - 搜索表单和编辑表单
- ✅ 需求管理 (`Requirement.vue`) - 搜索表单和编辑表单
- ✅ 测试管理 (`TestCase.vue`) - 搜索表单和编辑表单
- ✅ 任务管理 (`Task.vue`) - 搜索表单和编辑表单
- ✅ 版本管理 (`Version.vue`) - 搜索表单和编辑表单
- ✅ 构建管理 (`Build.vue`) - 搜索表单和编辑表单
- ✅ 资源管理 (`Resource.vue`) - 搜索表单、编辑表单和资源分配表单
- ✅ 资源日历 (`ResourceCalendar.vue`) - 搜索表单
- ✅ 资源利用率 (`ResourceUtilization.vue`) - 搜索表单
- ✅ 资源统计 (`ResourceStatistics.vue`) - 搜索表单

#### 用户体验提升
- **快速查找**：在项目较多时，可以通过输入快速定位目标项目
- **减少滚动**：过滤后列表更短，减少滚动操作
- **提升效率**：特别是在项目数量较多的情况下，显著提升选择效率

#### 技术实现
- 使用 Ant Design Vue 的 `show-search` 属性启用搜索功能
- 自定义 `filterProjectOption` 函数实现过滤逻辑
- 支持按项目名称和编码进行模糊匹配

### 2. 搜索栏折叠功能 ✨

#### 功能描述
为所有管理列表页面添加了搜索栏折叠/展开功能，用户可以根据需要控制搜索栏的显示状态，节省页面空间。

#### 功能特点
- **折叠/展开切换**：点击搜索栏标题旁的按钮可以折叠或展开搜索栏
- **默认折叠**：搜索栏默认处于折叠状态，节省页面空间
- **图标指示**：使用向上/向下箭头图标清晰指示当前状态
- **平滑过渡**：折叠和展开过程平滑自然

#### 涉及的页面
- ✅ 项目管理 (`Project.vue`)
- ✅ Bug管理 (`Bug.vue`)
- ✅ 需求管理 (`Requirement.vue`)
- ✅ 测试管理 (`TestCase.vue`)
- ✅ 任务管理 (`Task.vue`)
- ✅ 测试报告 (`TestReport.vue`)
- ✅ 版本管理 (`Version.vue`)
- ✅ 用户管理 (`User.vue`)
- ✅ 部门管理 (`Department.vue`)
- ✅ 产品管理 (`Product.vue`)
- ✅ 构建管理 (`Build.vue`)
- ✅ 资源管理 (`Resource.vue`)
- ✅ 报表 (`Report.vue`)

#### 用户体验提升
- **节省空间**：默认折叠状态让列表区域更大，显示更多内容
- **按需展开**：需要搜索时再展开，不影响正常浏览
- **操作便捷**：一键切换，操作简单直观

### 3. Bug列表界面优化 🎨

#### 优化内容

##### 行高限制
- 限制表格行高，避免内容过长导致行高过大
- 提升列表的紧凑性和可读性

##### 分页位置调整
- 优化分页组件的位置和布局
- 使分页控件更易于访问和操作

##### 间距优化
- 缩小页面元素之间的间距
- 提升页面空间利用率

##### 移除 page-header
- 移除多余的 page-header 组件
- 简化页面结构，减少视觉干扰

##### 默认每页20条
- 将默认每页显示数量从10条调整为20条
- 减少翻页次数，提升浏览效率

#### 优化效果
- **更紧凑的布局**：页面空间利用更高效
- **更好的可读性**：行高适中，内容清晰
- **更快的浏览**：默认显示更多内容，减少翻页
- **更简洁的界面**：移除冗余元素，界面更清爽

### 4. 用户管理：修改密码功能 🔐

#### 功能描述
在用户管理列表的操作列中，为每个用户添加了"修改密码"功能，管理员可以直接修改任意用户的密码。

#### 功能特点
- **便捷操作**：在用户列表的操作列中直接点击"修改密码"按钮
- **密码强度验证**：新密码必须满足强度要求（至少6位，包含大写字母、小写字母和数字）
- **确认密码**：需要输入两次密码进行确认，避免输入错误
- **安全可靠**：密码加密存储，符合安全规范

#### 使用场景
- 用户忘记密码，管理员代为重置
- 新用户首次登录需要设置密码
- 定期更换用户密码，提升安全性
- 批量用户密码管理

#### 界面设计
- **按钮位置**：位于"编辑"按钮旁边，操作便捷
- **对话框设计**：清晰的表单布局，包含用户名显示、新密码输入、确认密码输入
- **密码提示**：显示密码强度要求，帮助用户设置符合要求的密码
- **验证反馈**：实时验证密码格式和一致性，提供清晰的错误提示

#### 技术实现
- 使用现有的 `updateUser` API，传递 `nickname` 和 `password` 字段
- 前端表单验证确保密码强度和一致性
- 后端验证密码强度并加密存储

## 技术实现

### 项目选择下拉框输入过滤功能

#### 实现方案
1. **启用搜索功能**
   ```vue
   <a-select
     v-model:value="formData.project_id"
     placeholder="选择项目"
     show-search
     :filter-option="filterProjectOption"
   >
   ```

2. **过滤函数实现**
   ```typescript
   const filterProjectOption = (input: string, option: any) => {
     const project = projects.value.find(p => p.id === option.value)
     if (!project) return false
     const searchText = input.toLowerCase()
     return (
       project.name.toLowerCase().includes(searchText) ||
       (project.code && project.code.toLowerCase().includes(searchText))
     )
   }
   ```

3. **过滤逻辑**
   - 支持按项目名称过滤（不区分大小写）
   - 支持按项目编码过滤（如果存在，不区分大小写）
   - 使用 `includes` 方法实现模糊匹配

### 搜索栏折叠功能

#### 实现方案
1. **状态管理**
   ```typescript
   const searchFormVisible = ref(false) // 默认折叠
   ```

2. **切换函数**
   ```typescript
   const toggleSearchForm = () => {
     searchFormVisible.value = !searchFormVisible.value
   }
   ```

3. **模板实现**
   ```vue
   <a-form v-show="searchFormVisible" layout="inline" :model="searchForm">
     <!-- 搜索表单内容 -->
   </a-form>
   ```

4. **图标切换**
   ```vue
   <UpOutlined v-if="searchFormVisible" />
   <DownOutlined v-else />
   ```

### Bug列表界面优化

#### 样式调整
1. **行高限制**：使用 CSS 限制表格行高
2. **间距优化**：调整 margin 和 padding 值
3. **分页布局**：优化分页组件的位置和样式
4. **移除冗余**：删除 page-header 相关代码

### 修改密码功能

#### 前端实现
1. **表单数据**
   ```typescript
   const changePasswordFormData = reactive({
     id: 0,
     username: '',
     nickname: '',
     password: '',
     confirmPassword: ''
   })
   ```

2. **验证规则**
   - 密码强度验证：至少6位，包含大小写字母和数字
   - 确认密码验证：两次输入必须一致

3. **API调用**
   ```typescript
   await updateUser(changePasswordFormData.id, {
     nickname: changePasswordFormData.nickname,
     password: changePasswordFormData.password
   })
   ```

## 问题修复详情

### 修复的问题
- ✅ 项目选择下拉框不支持过滤，项目较多时选择困难
- ✅ 搜索栏占用过多页面空间
- ✅ Bug列表界面不够紧凑，行高过大
- ✅ 用户密码管理不便，需要编辑整个用户信息
- ✅ 默认每页显示数量较少，需要频繁翻页

### 修复后的效果
- ✅ 所有项目选择下拉框支持输入过滤，快速定位项目
- ✅ 搜索栏可以折叠，节省页面空间
- ✅ Bug列表界面更紧凑，显示更高效
- ✅ 可以直接修改用户密码，操作更便捷
- ✅ 默认显示更多内容，减少翻页操作

## 测试验证

### 测试场景
1. ✅ 所有项目选择下拉框的过滤功能正常
2. ✅ 项目名称和编码过滤功能正常
3. ✅ 所有管理页面的搜索栏折叠/展开功能正常
4. ✅ Bug列表界面显示优化效果符合预期
5. ✅ 用户管理修改密码功能正常
6. ✅ 密码强度验证正常工作
7. ✅ 确认密码验证正常工作
8. ✅ 修改密码后可以正常登录
9. ✅ 默认每页20条显示正常
10. ✅ 分页功能正常

### 测试结果
- 所有测试场景通过
- 界面交互体验显著提升
- 功能稳定可靠
- 无回归问题

## 更新内容

### 修改文件

**前端**：
- `frontend/src/views/project/Project.vue` - 添加搜索栏折叠功能，项目选择支持过滤
- `frontend/src/views/bug/Bug.vue` - 添加搜索栏折叠功能，优化界面显示，项目选择支持过滤
- `frontend/src/views/requirement/Requirement.vue` - 添加搜索栏折叠功能，项目选择支持过滤
- `frontend/src/views/test/TestCase.vue` - 添加搜索栏折叠功能，项目选择支持过滤
- `frontend/src/views/task/Task.vue` - 添加搜索栏折叠功能，项目选择支持过滤
- `frontend/src/views/test/TestReport.vue` - 添加搜索栏折叠功能
- `frontend/src/views/version/Version.vue` - 添加搜索栏折叠功能，项目选择支持过滤
- `frontend/src/views/user/User.vue` - 添加搜索栏折叠功能，添加修改密码功能
- `frontend/src/views/department/Department.vue` - 添加搜索栏折叠功能
- `frontend/src/views/product/Product.vue` - 添加搜索栏折叠功能
- `frontend/src/views/build/Build.vue` - 添加搜索栏折叠功能，项目选择支持过滤
- `frontend/src/views/resource/Resource.vue` - 添加搜索栏折叠功能，项目选择支持过滤
- `frontend/src/views/resource/ResourceCalendar.vue` - 项目选择支持过滤
- `frontend/src/views/resource/ResourceUtilization.vue` - 项目选择支持过滤
- `frontend/src/views/resource/ResourceStatistics.vue` - 项目选择支持过滤
- `frontend/src/views/report/Report.vue` - 添加搜索栏折叠功能

## 代码质量改进

### 用户体验
- **改进前**：项目选择下拉框不支持过滤，项目较多时选择困难；搜索栏始终显示，占用页面空间
- **改进后**：项目选择支持输入过滤，快速定位；搜索栏可折叠，按需显示
- **优势**：项目选择更高效，页面空间利用更高效，界面更清爽

### 操作效率
- **改进前**：修改用户密码需要编辑整个用户信息
- **改进后**：可以直接修改密码，操作更便捷
- **优势**：减少操作步骤，提升管理效率

### 界面优化
- **改进前**：Bug列表界面不够紧凑，默认显示数量少
- **改进后**：界面更紧凑，默认显示更多内容
- **优势**：信息密度更高，浏览效率提升

## 已知问题

无

## 后续计划

- 继续优化其他页面的用户体验
- 考虑添加更多批量操作功能
- 优化移动端响应式布局
- 考虑添加密码策略配置功能

## 升级指南

### 从 v0.4.6 升级

1. **代码更新**：拉取最新代码
   ```bash
   git pull origin main
   ```

2. **前端构建**：重新构建前端代码
   ```bash
   cd frontend
   npm install
   npm run build
   ```

3. **测试验证**：
   - 测试所有管理页面的搜索栏折叠功能
   - 验证Bug列表界面优化效果
   - 测试用户管理修改密码功能
   - 检查密码强度验证是否正常

### 注意事项

- 此版本主要进行界面优化和功能增强
- 不影响现有功能，仅改善用户体验
- 所有页面自动应用新的搜索栏折叠功能
- 修改密码功能需要管理员权限

## 开发体验改进

### 界面交互
- 统一的搜索栏折叠模式，便于新页面开发
- 清晰的交互逻辑，易于理解和维护
- 减少界面冗余，提升用户体验

### 功能完善
- 用户管理功能更完善，支持密码管理
- 界面优化提升操作效率
- 统一的交互模式，降低学习成本

## 致谢

感谢所有贡献者的支持和反馈！

---

**下载地址**: [GitHub Releases](https://github.com/funnywwh/goproject/releases/tag/v0.4.7)

